<ui:component xmlns="http://www.w3.org/1999/xhtml"
              xmlns:ui="http://java.sun.com/jsf/facelets"
              xmlns:p="http://primefaces.org/ui"
              xmlns:h="http://java.sun.com/jsf/html"
              xmlns:cc="http://java.sun.com/jsf/composite" 
              xmlns:f="http://xmlns.jcp.org/jsf/core">
    <cc:interface>
        <cc:attribute name="editable" type="java.lang.Boolean" required="true" shortDescription="is state editable?"/>
        <cc:attribute name="model" type="ru.entity.model.mapped.AccessControlledDocumentEntity" required="true" shortDescription="document"/>
        <cc:attribute name="controller" type=" ru.efive.dms.uifaces.beans.abstractBean.AbstractDocumentHolderBean" required="true"/>
        <cc:attribute name="editableReaders"  type="java.lang.Boolean" required="false" default="false"/>
        <cc:attribute name="editableEditors"  type="java.lang.Boolean" required="false" default="false"/>
    </cc:interface>

    <cc:implementation>
        <p:panelGrid style="width:100%">
            <p:row styleClass="ui-grid-row">
                <p:column styleClass="ui-grid-col-3">
                    <p:outputLabel value="Уровень допуска:"/>
                </p:column>
                <p:column styleClass="ui-grid-col-9">
                    <h:outputText value="#{cc.attrs.model.userAccessLevel.value}" rendered="#{not cc.attrs.editable}" styleClass="outputText"/>
                    <p:selectOneMenu value="#{cc.attrs.model.userAccessLevel}" converter="#{UserAccessLevelConverter}" rendered="#{cc.attrs.editable}">
                        <f:selectItems value="#{refBookHelper.getUserAccessLevelsGreaterOrEqualMaxValue(authData.currentAccessLevel.level)}"/>
                    </p:selectOneMenu>
                </p:column>
            </p:row>
            <p:row styleClass="ui-grid-row">
                <p:column styleClass="ui-grid-col-3">
                    <p:outputLabel value="Пользователи-читатели:" rendered="#{not cc.attrs.editableReaders}"/>
                    <p:commandButton value="Пользователи-читатели" actionListener="#{cc.attrs.controller.choosePersonReaders}" styleClass="dialogButton"
                                     rendered="#{cc.attrs.editableReaders}">
                        <p:ajax event="dialogReturn" listener="#{cc.attrs.controller.onPersonReadersChosen}" update="v_person_readers"/>
                    </p:commandButton>
                </p:column>
                <p:column styleClass="ui-grid-col-9">
                    <h:panelGroup id="v_person_readers">
                        <ui:repeat value="#{cc.attrs.model.personReadersList}" var="personReader">
                            <h:outputText value="#{personReader.description}" styleClass="outputText"/><br/>
                        </ui:repeat>
                    </h:panelGroup>
                </p:column>
            </p:row>
            <p:row styleClass="ui-grid-row">
                <p:column styleClass="ui-grid-col-3">
                    <p:outputLabel for="v_person_editors" value="Пользователи-редакторы:" rendered="#{not cc.attrs.editableEditors}"/>
                    <p:commandButton value="Пользователи-редакторы" actionListener="#{cc.attrs.controller.choosePersonEditors}" styleClass="dialogButton"
                                     rendered="#{cc.attrs.editableEditors}">
                        <p:ajax event="dialogReturn" listener="#{cc.attrs.controller.onPersonEditorsChosen}" update="v_person_editors"/>
                    </p:commandButton>
                </p:column>
                <p:column styleClass="ui-grid-col-9">
                    <h:panelGroup id="v_person_editors">
                        <ui:repeat value="#{cc.attrs.model.personEditorsList}" var="personEditor">
                            <h:outputText value="#{personEditor.description}" styleClass="outputText"/><br/>
                        </ui:repeat>
                    </h:panelGroup>
                </p:column>
            </p:row>
            <p:row styleClass="ui-grid-row">
                <p:column styleClass="ui-grid-col-3">
                    <p:outputLabel for="v_role_readers" value="Роли-читатели:" rendered="#{not cc.attrs.editableReaders}"/>
                    <p:commandButton value="Роли-читатели" actionListener="#{cc.attrs.controller.chooseRoleReaders}" rendered="#{cc.attrs.editableReaders}"
                                     styleClass="dialogButton">
                        <p:ajax event="dialogReturn" listener="#{cc.attrs.controller.onRoleReadersChosen}" update="v_role_readers"/>
                    </p:commandButton>
                </p:column>
                <p:column styleClass="ui-grid-col-9">
                    <h:panelGroup id="v_role_readers">
                        <ui:repeat value="#{cc.attrs.model.roleReadersList}" var="roleReader">
                            <h:outputText value="#{roleReader.value}" styleClass="outputText"/><br/>
                        </ui:repeat>
                    </h:panelGroup>
                </p:column>
            </p:row>
            <p:row styleClass="ui-grid-row">
                <p:column styleClass="ui-grid-col-3">
                    <p:outputLabel for="v_role_editors" value="Роли-редакторы:" rendered="#{not cc.attrs.editableEditors}"/>
                    <p:commandButton value="Роли-редакторы" actionListener="#{cc.attrs.controller.chooseRoleEditors}" rendered="#{cc.attrs.editableEditors}"
                                     styleClass="dialogButton">
                        <p:ajax event="dialogReturn" listener="#{cc.attrs.controller.onRoleEditorsChosen}" update="v_role_editors"/>
                    </p:commandButton>
                </p:column>
                <p:column styleClass="ui-grid-col-9">
                    <h:panelGroup id="v_role_editors">
                        <ui:repeat value="#{cc.attrs.model.roleEditorsList}" var="roleEditor">
                            <h:outputText value="#{roleEditor.value}" styleClass="outputText"/><br/>
                        </ui:repeat>
                    </h:panelGroup>
                </p:column>
            </p:row>
        </p:panelGrid>
    </cc:implementation>
</ui:component>