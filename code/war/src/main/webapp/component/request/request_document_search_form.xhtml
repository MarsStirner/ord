<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:e5ui="http://efive.ru/uitemplates"
      xmlns:e5ui-comp="http://efive.ru/uitemplates/composite" xmlns:p="http://primefaces.org/ui"
        >

<ui:composition template="/WEB-INF/jsf-template/template.xhtml">

<ui:define name="running_head">
    <e5ui-comp:userSessionUpdate rendered="true" interval="300"/>
    <h:outputScript library="js" name="primefacesLocale_ru.js"/>
    <h:outputStylesheet library="css" name="primefacesExtension/calendarIcon.css"/>
    <e5ui-comp:outputUtilScript/>
</ui:define>

<ui:define name="header">
    <div id="form_header">
        <div class="actionbar">
            <div class="menu">
                <div class="defbutton">
                    <h:outputLink value="/component/requst_documents.xhtml">
                        <h:graphicImage value="#{resource['images:home.png']}"/>
                    </h:outputLink>
                </div>
                <div class="defbutton">
                    <h:commandLink action="#{request_search_documents.search}" styleClass="searchbutton">
                        <h:graphicImage value="#{resource['images:button-search.png']}"/>
                        Найти
                    </h:commandLink>
                </div>
                <div class="defbutton">
                    <h:commandLink action="#{request_search_documents.clear}" styleClass="searchbutton">
                        <h:graphicImage value="#{resource['images:button-refresh.png']}"/>
                        Очистить
                    </h:commandLink>
                </div>
            </div>
        </div>
    </div>
</ui:define>

<ui:define name="left_menu"/>

<ui:define name="content">
<div id="header_content">
    <h:panelGroup rendered="true">
        <div class="name">Форма поиска</div>
    </h:panelGroup>
</div>

<div class="main_content">
<h:panelGroup rendered="true">
<div class="row">
<table class="form_grid">
<tr class="row">
    <td class="first">
        <label for="statusId">
            <span class="title">Статус документа: </span>
        </label>
    </td>
    <td class="second" colspan="3">
        <h:selectOneMenu id="statusId" value="#{request_search_documents.statusId}">
            <f:selectItem itemLabel="" itemValue=""/>
            <f:selectItem itemLabel="Зарегистрирован" itemValue="2"/>
            <f:selectItem itemLabel="На исполнении" itemValue="80"/>
            <f:selectItem itemLabel="Исполнен" itemValue="90"/>
            <f:selectItem itemLabel="В архиве" itemValue="100"/>
            <f:selectItem itemLabel="Изъят из архива" itemValue="110"/>
        </h:selectOneMenu>
    </td>
</tr>
<tr class="row">
    <td class="first">
        <label>
            <span class="title">
                <h:outputLink title="Автор"
                              onclick="authorSelectModalVar.clickOpen('authorSelectModal'); return false;">
                    Автор
                </h:outputLink>
            </span>
        </label>
        <e5ui-comp:modalWindow id="authorSelectModal"
                               modalWindowHolder="#{request_search_documents.authorSelectModal}"
                               render="author" execute="select_table"
                               showButtons="false" style="width: 500px;"
                               widgetVar="authorSelectModalVar">
            <div id="title">Выбор автора</div>
            <div id="modal_container" style="margin-top: 0;">
                <div class="searchbar">
                    <span style="float: left; margin-top: 3px">Поиск:&nbsp;</span>
                    <h:inputText id="filter_string"
                                 value="#{request_search_documents.authorSelectModal.userList.filter}"
                                 style="display:block; float:left; margin-right:10px;"
                                 title="Поиск"/>
                    <h:commandButton value=" "
                                     action="#{request_search_documents.authorSelectModal.userList.changePageOffset(0)}"
                                     styleClass="searchbutton">
                        <f:ajax
                                execute="authorSelectModal:filter_string"
                                render="authorSelectModal:ajaxModal authorSelectModal:authors_modal_paging"/>
                    </h:commandButton>
                </div>
                <div class="wrap" style="height: 300px;">
                    <div class="inner" style="height: 300px;">
                        <e5ui:dataTable id="select_table" border="0"
                                        cellpadding="0" cellspacing="0"
                                        value="#{request_search_documents.authorSelectModal.userList.documents}"
                                        var="row" grouping="false" width="100%">
                            <e5ui:row
                                    onclick="e5ui_util.clickElement(this, 'selectLink$');"
                                    styleClass="#{request_search_documents.authorSelectModal.selected(row)? 'grid_row_selected': ''}"/>
                            <e5ui:column>
                                <f:facet name="header">
                                    <p>Автор</p>
                                </f:facet>
                                <h:outputText value="#{row}" converter="PersonConverter"/>
                                <h:commandLink id="selectLink" style="display: none;"
                                               rendered="#{not request_search_documents.authorSelectModal.selected(row)}"
                                               action="#{request_search_documents.authorSelectModal.select(row)}"/>
                            </e5ui:column>
                        </e5ui:dataTable>
                    </div>
                </div>
                <div style="clear: both;">
                    <h:panelGroup id="authors_modal_paging">
                        <e5ui-comp:tablePager id="authors_pager"
                                              documentListHolder="#{request_search_documents.authorSelectModal.userList}"/>
                    </h:panelGroup>
                </div>
            </div>
            <div class="e5ui-modal-bottombuttons">
                <h:button onclick="authorSelectModalVar.clickSave(); return false;" value="Выбрать"/>
                <h:button onclick="authorSelectModalVar.clickClose(); return false;" value="Отмена"/>
            </div>
        </e5ui-comp:modalWindow>
    </td>
    <td class="second" colspan="3">
        <h:outputText id="author" value="#{request_search_documents.author}" converter="PersonConverter" class="wide"/>
    </td>
</tr>
<tr class="row">
    <td class="first">
        <label for="form">
            <span class="title">Вид документа: </span>
        </label>
    </td>
    <td class="second" colspan="3">
        <h:selectOneMenu id="form" value="#{request_search_documents.form}" converter="RequestDocumentFormConverter"
                         style="font-size:10pt;">
            <f:selectItems
                    value="#{dictionaryManagement.getDocumentFormsByCategoryWithEmptyValue('Обращения граждан')}"/>
        </h:selectOneMenu>
    </td>
</tr>
<tr class="row">
    <td class="first">
        <label for="registrationNumber">
            <span class="title">Регистрационный номер</span>
        </label>
    </td>
    <td class="second" colspan="3">
        <h:inputText id="registrationNumber" value="#{request_search_documents.registrationNumber}"/>
    </td>
</tr>
<tr class="row">
    <td class="first">
        <label for="startCreationDate">
            <span class="title">Дата создания: от</span>
        </label>
    </td>
    <td class="second">
        <p:calendar id="startCreationDate" value="#{request_search_documents.startCreationDate}" lang="ru"
                    locale="ru"
                    widgetVar="startCreationDateVar" pattern="dd.MM.yyyy" showOn="both"/>
    </td>
    <td class="first">
        <label for="endCreationDate">
            <span class="title">до</span>
        </label>
    </td>
    <td class="second">
        <p:calendar id="endCreationDate" value="#{request_search_documents.endCreationDate}" lang="ru"
                    locale="ru"
                    widgetVar="endCreationDateVar" pattern="dd.MM.yyyy" showOn="both"/>
    </td>
</tr>
<tr class="row">
    <td class="first">
        <label for="startRegistrationDate">
            <span class="title">Дата регистрации: от</span>
        </label>
    </td>
    <td class="second">
        <p:calendar id="startRegistrationDate" value="#{request_search_documents.startRegistrationDate}" lang="ru"
                    locale="ru"
                    widgetVar="startRegistrationDateVar" pattern="dd.MM.yyyy" showOn="both"/>
    </td>
    <td class="first">
        <label for="endRegistrationDate">
            <span class="title">до</span>
        </label>
    </td>
    <td class="second">
        <p:calendar id="endRegistrationDate" value="#{request_search_documents.endRegistrationDate}" lang="ru"
                    locale="ru"
                    widgetVar="endRegistrationDateVar" pattern="dd.MM.yyyy" showOn="both"/>
    </td>
</tr>
<tr class="row">
    <td class="first">
        <label for="startDeliveryDate">
            <span class="title">Дата поступления: от</span>
        </label>
    </td>
    <td class="second">
        <p:calendar id="startDeliveryDate" value="#{request_search_documents.startDeliveryDate}" lang="ru"
                    locale="ru"
                    widgetVar="startDeliveryDateVar" pattern="dd.MM.yyyy" showOn="both"/>
    </td>
    <td class="first">
        <label for="endDeliveryDate">
            <span class="title">до</span>
        </label>
    </td>
    <td class="second">
        <p:calendar id="endDeliveryDate" value="#{request_search_documents.endDeliveryDate}" lang="ru"
                    locale="ru"
                    widgetVar="endDeliveryDateVar" pattern="dd.MM.yyyy" showOn="both"/>
    </td>
</tr>
<tr class="row">
    <td class="first">
        <label for="startExecutionDate">
            <span class="title">Срок исполнения: от</span>
        </label>
    </td>
    <td class="second">
        <p:calendar id="startExecutionDate" value="#{request_search_documents.startExecutionDate}" lang="ru"
                    locale="ru"
                    widgetVar="startExecutionDate" pattern="dd.MM.yyyy" showOn="both"/>
    </td>
    <td class="first">
        <label for="endExecutionDate">
            <span class="title">до</span>
        </label>
    </td>
    <td class="second">
        <p:calendar id="endExecutionDate" value="#{request_search_documents.endExecutionDate}" lang="ru"
                    locale="ru"
                    widgetVar="endExecutionDate" pattern="dd.MM.yyyy" showOn="both"/>
    </td>
</tr>
<tr class="row">
    <td class="first">
        <label for="deliveryType">
            <span class="title">Тип доставки: </span>
        </label>
    </td>
    <td class="second" colspan="3">
        <h:selectOneMenu id="deliveryType" value="#{request_search_documents.deliveryType}"
                         converter="DeliveryTypeConverter" style="font-size:10pt;">
            <f:selectItems value="#{dictionaryManagement.deliveryTypesWithEmptyValue}"/>
        </h:selectOneMenu>
    </td>
</tr>
<tr class="row">
    <td class="first">
        <label for="senderLastName">
            <span class="title">Фамилия:</span>
        </label></td>
    <td class="second" colspan="3">
        <h:inputText id="senderLastName" value="#{request_search_documents.senderLastName}" class="wide"/>
    </td>
</tr>
<tr class="row">
    <td class="first">
        <label for="senderFirstName">
            <span class="title">Имя:</span>
        </label>
    </td>
    <td class="second" colspan="3">
        <h:inputText id="senderFirstName" value="#{request_search_documents.senderFirstName}" class="wide"/>
    </td>
</tr>
<tr class="row">
    <td class="first">
        <label for="senderMiddleName">
            <span class="title">Отчество:</span>
        </label>
    </td>
    <td class="second" colspan="3">
        <h:inputText id="senderMiddleName" value="#{request_search_documents.senderMiddleName}" class="wide"/>
    </td>
</tr>
<tr class="row">
    <td class="first">
        <label>
            <span class="title">
                <h:outputLink title="Ответственный исполнитель"
                              onclick="executorSelectModalVar.clickOpen('executorSelectModal'); return false;">
                    Ответственный исполнитель
                </h:outputLink>
            </span>
        </label>
        <e5ui-comp:modalWindow id="executorSelectModal"
                               modalWindowHolder="#{request_search_documents.executorSelectModal}"
                               render="executor" execute="select_table"
                               showButtons="false" style="width: 500px;"
                               widgetVar="executorSelectModalVar">
            <div id="title">Выбор исполнителя</div>
            <div id="modal_container" style="margin-top: 0;">
                <div class="searchbar">
                    <span style="float: left; margin-top: 3px">Поиск:&nbsp;</span>
                    <h:inputText id="filter_string"
                                 value="#{request_search_documents.executorSelectModal.userList.filter}"
                                 style="display:block; float:left; margin-right:10px;"
                                 title="Поиск"/>
                    <h:commandButton value=" "
                                     action="#{request_search_documents.executorSelectModal.userList.changePageOffset(0)}"
                                     styleClass="searchbutton">
                        <f:ajax
                                execute="executorSelectModal:filter_string"
                                render="executorSelectModal:ajaxModal executorSelectModal:executors_modal_paging"/>
                    </h:commandButton>
                </div>
                <div class="wrap" style="height: 300px;">
                    <div class="inner" style="height: 300px;">
                        <e5ui:dataTable id="select_table" border="0"
                                        cellpadding="0" cellspacing="0"
                                        value="#{request_search_documents.executorSelectModal.userList.documents}"
                                        var="row" grouping="false" width="100%">
                            <e5ui:row
                                    onclick="e5ui_util.clickElement(this, 'selectLink$');"
                                    styleClass="#{request_search_documents.executorSelectModal.selected(row)? 'grid_row_selected': ''}"/>
                            <e5ui:column>
                                <f:facet name="header">
                                    <p>Ответственный исполнитель</p>
                                </f:facet>
                                <h:outputText value="#{row}" converter="PersonConverter"/>
                                <h:commandLink id="selectLink" style="display: none;"
                                               rendered="#{not request_search_documents.executorSelectModal.selected(row)}"
                                               action="#{request_search_documents.executorSelectModal.select(row)}"/>
                            </e5ui:column>
                        </e5ui:dataTable>
                    </div>
                </div>
                <div style="clear: both;">
                    <h:panelGroup id="executors_modal_paging">
                        <e5ui-comp:tablePager id="executors_pager"
                                              documentListHolder="#{request_search_documents.executorSelectModal.userList}"/>
                    </h:panelGroup>
                </div>
            </div>
            <div class="e5ui-modal-bottombuttons">
                <h:button onclick="executorSelectModalVar.clickSave(); return false;" value="Выбрать"/>
                <h:button onclick="executorSelectModalVar.clickClose(); return false;" value="Отмена"/>
            </div>
        </e5ui-comp:modalWindow>
    </td>
    <td class="second" colspan="3">
        <h:outputText id="executor" value="#{request_search_documents.executor}" converter="PersonConverter"
                      class="wide"/>
    </td>
</tr>
<tr class="row">
    <td class="first">
        <label>
            <span class="title">
                <h:outputLink title="Адресаты:"
                              onclick="userListSelectModalVar.clickOpen('recipientUsersSelectModal'); return false;">
                    Адресаты
                </h:outputLink>
            </span>
        </label>
        <e5ui-comp:modalWindow id="recipientUsersSelectModal"
                               modalWindowHolder="#{request_search_documents.recipientUsersSelectModal}"
                               render="recipients" execute="select_table"
                               showButtons="false" style="width: 500px;"
                               widgetVar="userListSelectModalVar">
            <div id="title">Выбор адресатов</div>
            <div id="modal_container" style="margin-top: 0;">
                <div class="searchbar">
                    <span style="float: left; margin-top: 3px">Поиск:&nbsp;</span>
                    <h:inputText id="filter_string"
                                 value="#{request_search_documents.recipientUsersSelectModal.userList.filter}"
                                 style="display:block; float:left; margin-right:10px;"
                                 title="Поиск"/>
                    <h:commandButton value=" "
                                     action="#{request_search_documents.recipientUsersSelectModal.userList.changePageOffset(0)}"
                                     styleClass="searchbutton">
                        <f:ajax
                                execute="recipientUsersSelectModal:filter_string"
                                render="recipientUsersSelectModal:ajaxModal recipientUsersSelectModal:modal_paging"/>
                    </h:commandButton>
                </div>
                <div class="wrap" style="height: 300px;">
                    <div class="inner" style="height: 300px;">
                        <e5ui:dataTable id="select_table" border="0"
                                        cellpadding="0" cellspacing="0"
                                        value="#{request_search_documents.executorSelectModal.userList.documents}"
                                        var="row"
                                        grouping="false" width="100%">
                            <e5ui:row
                                    onclick="e5ui_util.clickElement(this, 'selectLink$');"
                                    styleClass="#{request_search_documents.recipientUsersSelectModal.selected(row)? 'grid_row_selected': ''}"/>
                            <e5ui:column>
                                <f:facet name="header">
                                    <p>Адресаты</p>
                                </f:facet>
                                <h:outputText value="#{row}" converter="PersonConverter"/>
                                <h:commandLink id="selectLink" style="display: none;"
                                               rendered="#{not request_search_documents.recipientUsersSelectModal.selected(row)}"
                                               action="#{request_search_documents.recipientUsersSelectModal.select(row)}"/>
                                <h:commandLink id="unselectLink" style="display: none;"
                                               rendered="#{request_search_documents.recipientUsersSelectModal.selected(row)}"
                                               action="#{request_search_documents.recipientUsersSelectModal.unselect(row)}"/>
                            </e5ui:column>
                        </e5ui:dataTable>
                    </div>
                </div>
                <div style="clear: both;">
                    <h:panelGroup id="modal_paging">
                        <e5ui-comp:tablePager id="pager"
                                              documentListHolder="#{request_search_documents.recipientUsersSelectModal.userList}"/>
                    </h:panelGroup>
                </div>
            </div>
            <div class="e5ui-modal-bottombuttons">
                <h:button onclick="userListSelectModalVar.clickSave(); return false;" value="Выбрать"/>
                <h:button onclick="userListSelectModalVar.clickClose(); return false;" value="Отмена"/>
            </div>
        </e5ui-comp:modalWindow>
    </td>
    <td class="second" colspan="3">
        <div style="overflow-y: scroll; height: 60px">
            <h:panelGroup id="recipients">
                <label>
                    <ui:repeat value="#{request_search_documents.recipientUsers}" var="element">
                        <h:outputText value="#{element}" converter="PersonConverter" class="width"/>
                        <br/>
                    </ui:repeat>
                </label>
            </h:panelGroup>
        </div>
    </td>
</tr>
<tr class="row">
    <td class="first">
        <label for="shortDescription">
            <span class="title">Краткое содержание</span>
    </label>
    </td>
    <td class="second" colspan="3">
        <h:inputText id="shortDescription" value="#{request_search_documents.shortDescription}" class="wide"/>
     </td>
</tr>
<tr class="row">
    <td class="first"/>
    <td class="second"/>
    <td class="third"/>
    <td class="fourth"/>
</tr>
</table>
</div>
</h:panelGroup>

</div>

<p:ajaxStatus onstart="PF('statusDialog').show()" oncomplete="PF('statusDialog').hide()"/>
<p:dialog widgetVar="statusDialog" modal="true" draggable="false" closable="false" resizable="false" showHeader="false">
    Пожалуйста, подождите...
</p:dialog>
</ui:define>

<ui:define name="footer">
    <h:outputStylesheet library="css" name="datatable.css"/>
    <h:outputStylesheet library="css" name="modalWindow.css"/>
</ui:define>

</ui:composition>

</html>