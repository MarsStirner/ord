<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:e5ui-comp="http://efive.ru/uitemplates/composite"
      xmlns:p="http://primefaces.org/ui"
        >

<ui:composition template="/jsf-template/referenceBookItemTemplate.xhtml">
    <ui:define name="running_head">
        <e5ui-comp:outputUtilScript/>
        <h:outputStylesheet library="css" name="datatable.css"/>
        <h:outputScript library="js" name="primefacesLocale_ru.js"/>
        <h:outputStylesheet library="css" name="primefacesExtension/calendarIcon.css"/>
    </ui:define>
    <ui:define name="headerEditButton">
        <div class="defbutton">
            <h:commandLink action="#{numerator.edit}" rendered="#{numerator.viewState and numerator.canEdit}">
                <h:graphicImage value="#{resource['images:edit_buttn.png']}"/>
                Редактировать
            </h:commandLink>
        </div>
    </ui:define>
    <ui:define name="headerSaveButton">
        <div class="defbutton">
            <h:commandLink action="#{numerator.save}" rendered="#{numerator.editState or numerator.createState}">
                <h:graphicImage value="#{resource['images:save_buttn.png']}"/>
                Сохранить
            </h:commandLink>
        </div>
    </ui:define>
    <ui:define name="headerCancelButton">
        <div class="defbutton">
            <h:commandLink action="#{numerator.cancel}" rendered="#{numerator.editState or numerator.createState}">
                <h:graphicImage value="#{resource['images:button-cancel.png']}"/>
                Отменить
            </h:commandLink>
        </div>
    </ui:define>
    <ui:define name="headerDeleteButton">
        <div class="defbutton">
            <h:commandLink action="#{numerator.delete()}" rendered="#{isAdministrator and numerator.viewState and numerator.canDelete}">
                <h:graphicImage value="#{resource['images:dell_buttn.png']}"/>
                Удалить
                <f:param name="docAction" value="delete"/>
            </h:commandLink>
        </div>
    </ui:define>
    <ui:define name="contentReferenceBookName">Справочник Нумераторов</ui:define>

    <ui:define name="contentItemName">
        <h:panelGroup rendered="#{numerator.createState}">
            <div class="name">Новый нумератор</div>
        </h:panelGroup>
        <h:panelGroup rendered="#{numerator.editState or numerator.viewState}">
            <div class="name">
                <h:outputText value="Нумератор от "/>
                <h:outputText value="#{numerator.document.creationDate}">
                    <f:convertDateTime pattern="dd.MM.yyyy"/>
                </h:outputText>
            </div>
        </h:panelGroup>
        <h:panelGroup rendered="#{numerator.notFoundState}">
            <div class="name">404 - Нумератор не найден</div>
        </h:panelGroup>
        <h:panelGroup rendered="#{numerator.forbiddenState}">
            <div class="name">403 - Действие запрещено</div>
        </h:panelGroup>
        <h:panelGroup
                rendered="#{not(numerator.createState or numerator.editState or numerator.viewState or numerator.notFoundState or numerator.forbiddenState)}">
            <div class="name">В доступе отказано</div>
        </h:panelGroup>
    </ui:define>

    <ui:define name="contentItemInfo">
        <p:growl id="numeratorMessages"/>
        <h:panelGroup rendered="#{numerator.viewState}">
            <div class="row">
                <table class="form_grid">
                    <tr class="row">
                        <td class="first">
                            <label>
                                <span class="title">Дата создания:</span>
                            </label>
                        </td>
                        <td>
                            <h:outputText value="#{numerator.document.creationDate}">
                                <f:convertDateTime pattern="dd.MM.yyyy HH:mm:ss"/>
                            </h:outputText>
                        </td>
                    </tr>
                    <tr class="row">
                        <td class="first">
                            <label>
                                <span class="title">Автор</span>
                            </label>
                        </td>
                        <td>
                            <h:outputText value="#{numerator.document.author.getDescription()}"/>
                        </td>
                    </tr>
                    <tr class="row">
                        <td class="first">
                            <label>
                                <span class="title">Тип документа</span>
                            </label>
                        </td>
                        <td>
                            <h:outputText value="//TODO #{numerator.document.documentType}"/>
                        </td>
                    </tr>
                    <tr class="row">
                        <td class="first">
                            <label>
                                <span class="title">Номенклатура</span>
                            </label>
                        </td>
                        <td>
                            <h:outputText
                                    value="#{numerator.document.nomenclature != null ? numerator.document.nomenclature.code.concat('-').concat(numerator.document.nomenclature.value) : 'Отсутствует(любая номенклатура)'}"/>
                        </td>
                    </tr>
                    <tr class="row">
                        <td class="first">
                            <label>
                                <span class="title">Текущий номер</span>
                            </label>
                        </td>
                        <td>
                            <h:outputText value="#{numerator.document.value}"/>
                        </td>
                    </tr>
                    <tr class="row">
                        <td class="first">
                            <label>
                                <span class="title">Комментарий</span>
                            </label>
                        </td>
                        <td>
                            <h:outputText value="#{numerator.document.shortDescription}"/>
                        </td>
                    </tr>
                    <tr class="row">
                        <td class="first">
                            <label>
                                <span class="title">Срок действия</span>
                            </label>
                        </td>
                        <td>
                            <h:outputFormat value="С {0, date, dd.MM.yyyy} ПО {1, date, dd.MM.yyyy}">
                                <f:param value="#{numerator.document.startDate}"/>
                                <f:param value="#{numerator.document.endDate}"/>
                            </h:outputFormat>
                        </td>
                    </tr>
                </table>
            </div>
        </h:panelGroup>
        <h:panelGroup rendered="#{numerator.createState or numerator.editState}">
            <div class="row">
                <table class="form_grid">
                    <tr class="row">
                        <td class="first">
                            <label>
                                <span class="title">Дата создания:</span>
                            </label>
                        </td>
                        <td>
                            <h:outputText value="#{numerator.document.creationDate}">
                                <f:convertDateTime pattern="dd.MM.yyyy HH:mm:ss"/>
                            </h:outputText>
                        </td>
                    </tr>
                    <tr class="row">
                        <td class="first">
                            <label>
                                <span class="title">Автор</span>
                            </label>
                        </td>
                        <td>
                            <h:outputText value="#{numerator.document.author.getDescription()}"/>
                        </td>
                    </tr>
                    <tr class="row">
                        <td class="first">
                            <label>
                                <span class="title">Тип документа</span>
                            </label>
                        </td>
                        <td>
                            <h:outputText value="//TODO DROP-down with default from get params #{numerator.document.documentType}"/>
                        </td>
                    </tr>
                    <tr class="row">
                        <td class="first">
                            <label>
                                <span class="title">Номенклатура</span>
                            </label>
                        </td>
                        <td>
                            <p:selectOneMenu id="numeratorNomenclatureSelectOneMenu" value="#{numerator.document.nomenclature}"
                                             converter="NomenclatureConverter" style="width:100%">
                                <f:selectItems value="#{dictionaryManagement.getNomenclatureWithEmptyValue()}" var="nomenclature_row"
                                               itemLabel="#{nomenclature_row.code}-#{nomenclature_row.value}"/>
                            </p:selectOneMenu>
                        </td>
                    </tr>
                    <tr class="row">
                        <td class="first">
                            <label>
                                <span class="title">Текущий номер</span>
                            </label>
                        </td>
                        <td>
                            <h:outputText value="#{numerator.document.value}"/>
                        </td>
                    </tr>
                    <tr class="row">
                        <td class="first">
                            <label>
                                <span class="title">Комментарий</span>
                            </label>
                        </td>
                        <td>
                            <p:inputText value="#{numerator.document.shortDescription}" style="width:100%;"/>
                        </td>
                    </tr>
                    <tr class="row">
                        <td class="first">
                            <label>
                                <span class="title">Срок действия</span>
                            </label>
                        </td>
                        <td>
                            <h:outputText value="C "/>
                            <p:calendar id="startDateCalendar" value="#{numerator.document.startDate}" lang="ru"
                                        locale="ru"
                                        widgetVar="startDateCalendarVar" pattern="dd.MM.yyyy" showOn="both"/>
                            <h:outputText value=" ПО "/>
                            <p:calendar id="endDateCalendar" value="#{numerator.document.endDate}" lang="ru"
                                        locale="ru"
                                        widgetVar="endDateCalendarVar" pattern="dd.MM.yyyy" showOn="both"/>
                        </td>
                    </tr>
                </table>
            </div>
        </h:panelGroup>
    </ui:define>


</ui:composition>

</html>